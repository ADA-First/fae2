{% extends "base.html" %}
{% load tz %}

{% load staticfiles i18n %}

{% block breadcrumb %}
    <li>Archived</li>
{% endblock %}

{% block title %}
Archived Reports
{% endblock %}

{% block content %}


<section aria-labelledby="id_reports_label">
   <h2 id="id_reports_label" class="sr-only">{{ reports.count }} reports</h2> 

   <table id="id_table_reports" class="details table table-striped table-hover sortable"  aria-labelledby="id_reports_label">
        <thead>
            <tr>
                <th  class="text"><abbr title="Permanent">Perm</abbr></th>
                <th  class="text">Title</th>
                <th  class="text"><abbr title="Date and time of evaluation">Date/Time</abbr></th>
                <th  class="num" >Pages</th>
                <th  class="text">Ruleset</th>
                <th  class="text">URL</th>
                <th  class="num" >Depth</th>
                <th  class="text" >Export</th>
            </tr>
        </thead>
        <tbody>
            {% if reports.count %}
            {% for report in reports %}
            <tr>
                <td class="text">
                    {% if report.archive %}Y{% endif %}
                </td>
                
                <td id="id_title_{{forloop.count}}" class="text" style="min-width: 15em;">
                    <a href="{% url 'report_rules' report.slug 'rc' %}">
                    {% if report.title %}
                        {{ report.title }}
                    {% else %}
                        {{ report.url }}
                    {% endif %}
                    </a>
                </td>
                
                <td class="text date">
                    {{ report.created|date:"Y-m-d H:i" }}
                </td>

                <td class="num"> {{ report.page_all_results.count }}</td> 
                
                <td class="text">{{ report.ruleset     }}</td>

                <td class="text">{{ report.url }}</td>
                
                <td class="num"> {{ report.depth                  }}</td>

                <td class="text"><a href="{% url 'report_json' report.slug %}" aria-label="JSON results for {{report.title}}">json</a></td>

            </tr>
            {% endfor %}
            {% else %}
            <tr>
                <td>No reports available</td>
            </tr>
            {% endif %}
            
        </tbody>
        
    </table>

    <ul class="user_profile">
        <li>Maximum archived reports: <strong>{{user_profile.max_archive}}</strong></li>
        <li>Maximum permanent reports: <strong>{{user_profile.max_permanent}}</strong></li>
    </ul>
</section>

{% if old_reports.count %}

<section aria-labelledby="id_other_reports_label" style="margin-top: 4em;">
    <h2 id="id_other_reports_label">Old Reports</h2> 
    <p>Old reports will be automatically deleted within the next 24 hours.  
    Use the <a href="{% url 'manage_reports' %}">Manage Reports</a> option to delete a report immediately or to make the report part of your group of permanent reports.</p>
   <table id="id_table_other_reports" class="details table table-striped table-hover sortable"  aria-labelledby="id_other_reports_label">
        <thead>
            <tr>
                <th  class="text"><abbr title="Permanent">Perm</abbr></th>
                <th  class="text">Title</th>
                <th  class="text"><abbr title="Date and time of evaluation">Date/Time</abbr></th>
                <th  class="num" >Pages</th>
                <th  class="text">Ruleset</th>
                <th  class="text">URL</th>
                <th  class="num" >Depth</th>
                <th  class="text" >Export</th>
            </tr>
        </thead>
        <tbody>
            {% for report in old_reports.all %}
            <tr>
                <td class="text">
                    {% if report.archive %}Y{% endif %}
                </td>
                
                <td id="id_title_{{forloop.count}}" class="text" style="min-width: 15em;">
                    <a href="{% url 'report_rules' report.slug 'rc' %}">
                    {% if report.title %}
                        {{ report.title }}
                    {% else %}
                        {{ report.url }}
                    {% endif %}
                    </a>
                </td>
                
                <td class="text date">
                    {{ report.created|date:"Y-m-d H:i" }}
                </td>

                <td class="num"> {{ report.page_all_results.count }}</td> 
                
                <td class="text">{{ report.ruleset     }}</td>

                <td class="text">{{ report.url }}</td>
                
                <td class="num"> {{ report.depth                  }}</td>

                <td class="text"><a href="{% url 'report_json' report.slug %}" aria-label="JSON results for {{report.title}}">json</a></td>

            </tr>
            {% endfor %}
            
        </tbody>
        
    </table>  
{% endif %}
    
</section>


{% endblock %}